var H=Object.defineProperty;var P=(O,e,t)=>e in O?H(O,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):O[e]=t;var a=(O,e,t)=>P(O,typeof e!="symbol"?e+"":e,t);import{P as h}from"./phaser-0RJB29YE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();class N extends h.Scene{constructor(){super({key:"Boot"})}preload(){}create(){console.log("[BootScene] Game booting..."),this.scene.start("Preload")}}const M="/game/assets/juan_gorilla_idle-BsnzEV9c.png",L="/game/assets/juan_gorilla_running-TvFPiYl8.png",v="/game/assets/juan_gorilla_jumping-BIdUPXlI.png",K="/game/assets/juan_gorilla_punch-C_GpB-67.png",U="/game/assets/juan_gorilla_uppercut-CB4sgUhJ.png",F="/game/assets/juan_gorilla_aerial_punch-CyAjFjWa.png",G="/game/assets/juan_gorilla_getting_punched-CtDaSUG0.png",W="/game/assets/juan_getting_punched_stomach-DGDtJ0MV.png",j="/game/assets/juan_dodge_punch_animation-CZODCw1_.png",V="/game/assets/juan_matrix_style_dodge-DeHhq7F2.png",X="/game/assets/juan_kipup_animation-380gj7Ov.png",Y="/game/assets/punch-C-qGnABi.mp3",J="/game/assets/kick-Ce8Jwexu.mp3",z="/game/assets/power-up-CYFvNnzm.wav",q="/game/assets/menu_music-D6iCQaNC.mp3",$="/game/assets/server_lab-CcU8GPHb.png",Q="/game/assets/overgrown_city-CaUShAkU.png",Z="/game/assets/overgrown_city_sunset-DuRpy8Sf.png",ee="/game/assets/versus-g9w5INHK.png",te="/game/assets/juan_sidekick_main_menu-BL6L_165.png",se="/game/assets/server_lab_floor-2063oOqD.png",ie="/game/assets/overgrown_ground_floor-Xn4oD4-L.png",ne="/game/assets/overgrown_floating_platform_350-B9hCc7z5.png",ae="/game/assets/floating_scaffolding-DuwyCVCH.png",re="/game/assets/power-booster-B1xfn4ZW.png",oe="/game/assets/enemy_blockhead_idle-CtZw0zbh.png",he="/game/assets/enemy_blockhead_running-CzQzil4O.png",ce="/game/assets/enemy_blockhead_punch-CHC-Df8c.png",le="/game/assets/enemy_blockhead_sidekick-D_BYc4j8.png",ue="/game/assets/enemy_blockhead_getting_punched-BDgPnVym.png";class de extends h.Scene{constructor(){super({key:"Preload"})}preload(){this.createLoadingBar(),this.load.spritesheet("juan-idle",M,{frameWidth:200,frameHeight:400}),this.load.spritesheet("running-animation",L,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-jump",v,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-punch",K,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-uppercut",U,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-aerial-punch",F,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-getting-punched",G,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-getting-punched-stomach",W,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-dodge",j,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-matrix-dodge",V,{frameWidth:200,frameHeight:400}),this.load.spritesheet("juan-kipup",X,{frameWidth:200,frameHeight:400}),this.load.audio("punch-sfx",Y),this.load.audio("kick-sfx",J),this.load.audio("power-up-sfx",z),this.load.audio("menu-music",q),this.load.image("bg-server-lab",$),this.load.image("bg-overgrown-city",Q),this.load.image("bg-overgrown-city-sunset",Z),this.load.image("versus-bg",ee),this.load.image("juan-menu",te),this.load.image("floor-server-lab",se),this.load.image("floor-overgrown-city",ie),this.load.image("floating-platform",ne),this.load.image("floating-scaffolding",ae),this.load.image("power-booster",re),this.load.spritesheet("enemy-idle",oe,{frameWidth:200,frameHeight:400}),this.load.spritesheet("enemy-running",he,{frameWidth:200,frameHeight:400}),this.load.spritesheet("enemy-punch",ce,{frameWidth:200,frameHeight:400}),this.load.spritesheet("enemy-sidekick",le,{frameWidth:200,frameHeight:400}),this.load.spritesheet("enemy-getting-punched",ue,{frameWidth:200,frameHeight:400})}createLoadingBar(){const s=(m-400)/2,i=(d-30)/2,n=this.add.graphics();n.fillStyle(3355443,1),n.fillRect(s,i,400,30);const o=this.add.graphics(),r=this.add.text(m/2,i-30,"Loading...",{fontFamily:"Arial",fontSize:"24px",color:"#ffffff"});r.setOrigin(.5);const c=this.add.text(m/2,i+30/2,"0%",{fontFamily:"Arial",fontSize:"18px",color:"#ffffff"});c.setOrigin(.5),this.load.on("progress",u=>{o.clear(),o.fillStyle(4906624,1),o.fillRect(s,i,400*u,30),c.setText(`${Math.round(u*100)}%`)}),this.load.on("complete",()=>{o.destroy(),n.destroy(),r.destroy(),c.destroy()})}create(){console.log("[PreloadScene] All assets loaded!");const e=this.add.graphics();e.fillStyle(16777215,1),e.fillCircle(4,4,4),e.generateTexture("particle",8,8),e.destroy(),this.textures.get("juan-menu").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-idle").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("running-animation").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-jump").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-punch").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-uppercut").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-aerial-punch").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-getting-punched").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-getting-punched-stomach").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-dodge").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-matrix-dodge").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("juan-kipup").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-idle").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-running").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-punch").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-sidekick").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-getting-punched").setFilter(h.Textures.FilterMode.LINEAR),this.textures.get("enemy-punch").add("punch_extend",0,600,0,400,400);const s=this.textures.get("enemy-sidekick");s.add("kick_extend",0,600,0,400,400),s.add("kick_follow",0,0,400,400,400);const i=this.textures.get("juan-aerial-punch");i.add("windup",0,200,0,400,400),i.add("punch",0,600,0,400,400);const n=this.textures.get("juan-matrix-dodge");n.add("lean_deep",0,600,0,400,400),n.add("crouch_1",0,0,400,400,400),this.waitForFonts().then(()=>{this.time.delayedCall(200,()=>{this.scene.start("Versus")})})}async waitForFonts(){const e=["Quantico","Russo One"];for(const t of e){const s=document.createElement("span");s.style.fontFamily=t,s.style.position="absolute",s.style.visibility="hidden",s.textContent="Font preload test",document.body.appendChild(s),setTimeout(()=>s.remove(),100)}document.fonts&&document.fonts.ready&&(await document.fonts.ready,console.log("[PreloadScene] Fonts loaded successfully"))}}class me extends h.Scene{constructor(){super({key:"Menu"});a(this,"buttons",[]);a(this,"selectedIndex",0);a(this,"menuMusic");a(this,"canNavigate",!0);a(this,"isMuted",!1);a(this,"muteButton");a(this,"juanSprite");a(this,"swooshGraphics");a(this,"buttonParticles");a(this,"buttonContainer");a(this,"buttonGroup");a(this,"BUTTON_WIDTH",350);a(this,"BUTTON_HEIGHT",80);a(this,"BUTTON_X",m-550);a(this,"BUTTON_Y_START",250);a(this,"BUTTON_SPACING",125);a(this,"JUAN_FINAL_X",400);a(this,"TITLE_FONT_SIZE","90px");a(this,"TITLE_FONT_FAMILY","Quantico");a(this,"TITLE_NAME","HUMANS VS BOTS")}create(){console.log("[MenuScene] Showing main menu"),this.buttons=[],this.selectedIndex=0,this.isMuted=this.registry.get("musicMuted")||!1,this.createBackground(),this.createParticles(),this.startMenuMusic(),this.createTitle(),this.createButtons(),this.createButtonParticles(),this.createJuanEntrance(),this.createMuteButton(),this.setupKeyboardNavigation(),this.updateSelection()}createBackground(){var n;const t=this.add.image(m/2,d/2,"bg-server-lab");t.setDisplaySize(m,d),t.setDepth(-100),(n=t.preFX)==null||n.addBlur(0,3,3,.3);const s=this.add.graphics();s.fillStyle(0,.35),s.fillRect(0,0,m,d),s.setDepth(-99);const i=this.add.graphics();for(let o=0;o<40;o++){const r=o/50*.3,c=Math.max(m,d)*(.65+o/100);i.lineStyle(15,0,r),i.strokeRect((m-c)/2,(d-c)/2,c,c)}i.setDepth(-98)}createParticles(){var s;const t=this.add.particles(0,0,"particle",{x:{min:this.JUAN_FINAL_X-250,max:this.JUAN_FINAL_X+250},y:{min:d/3,max:d+50},speedY:{min:-30,max:-60},speedX:{min:-10,max:10},lifespan:6e3,quantity:1,frequency:150,alpha:{start:.4,end:0},scale:{start:.7,end:.2},tint:[12318672,12248829],blendMode:h.BlendModes.ADD});t.setDepth(-50),(s=t.postFX)==null||s.addGlow(16777215,4,0,!1,.5,16)}createTitle(){var s;const t=this.add.text(m/2,70,this.TITLE_NAME,{fontFamily:this.TITLE_FONT_FAMILY,fontSize:this.TITLE_FONT_SIZE,color:"#ffffff",stroke:"#000000",strokeThickness:8,shadow:{offsetX:2,offsetY:6,color:"#000000",blur:1,stroke:!0,fill:!0}});t.setOrigin(.5),t.setDepth(10),(s=t.postFX)==null||s.addGlow(4906624,3,0,!1,.4,16)}createButtons(){this.buttonGroup=this.add.container(0,0),this.buttonGroup.setDepth(8),this.drawButtonContainer(),["FIGHT","STORY","CREDITS"].forEach((s,i)=>{const n=this.BUTTON_Y_START+i*this.BUTTON_SPACING,o=this.BUTTON_X+this.BUTTON_WIDTH/2,r=n,c=this.add.graphics();c.setDepth(9);const u=this.add.text(o,r,s,{fontFamily:"Quantico",fontSize:"60px",color:"#ffffff",stroke:"#000000",strokeThickness:6});u.setOrigin(.5),u.setDepth(11);const l=this.add.rectangle(o,r,this.BUTTON_WIDTH,this.BUTTON_HEIGHT,0,0);l.setInteractive({useHandCursor:!0}),l.setDepth(12);let y;s==="FIGHT"?y=()=>this.startGame():s==="STORY"?y=()=>this.scene.start("Story"):y=()=>this.scene.start("Credits"),u.setScale(1,1),l.on("pointerover",()=>{this.selectedIndex!==i&&(this.selectedIndex=i,this.updateSelection(),this.playSound("power-up-sfx",.4))}),l.on("pointerdown",()=>{this.playSound("punch-sfx",.5),y()}),this.buttons.push({frame:c,text:u,action:y,label:s,hitArea:l})}),this.animateButtonsEntrance()}animateButtonsEntrance(){this.buttons.forEach(s=>{s.frame.x+=400,s.text.x+=400,s.hitArea.x+=400}),this.buttonContainer&&(this.buttonContainer.x+=400),this.buttons.forEach((s,i)=>{const n=i*100;this.tweens.add({targets:[s.frame,s.text,s.hitArea],x:"-=400",duration:600,delay:n,ease:"Back.easeOut",easeParams:[1.2]})}),this.buttonContainer&&this.tweens.add({targets:this.buttonContainer,x:"-=400",duration:700,ease:"Back.easeOut",easeParams:[1.2]})}drawButtonContainer(){this.buttonContainer=this.add.graphics(),this.buttonContainer.setDepth(7);const t=this.buttonContainer,s=50,i=30,n=this.BUTTON_X-s,o=this.BUTTON_Y_START-this.BUTTON_HEIGHT/2-i,r=this.BUTTON_WIDTH+s*2,c=this.BUTTON_SPACING*2+this.BUTTON_HEIGHT+i*2,u=16777215,l=16777215;t.lineStyle(1,u,.3),t.strokeRoundedRect(n,o,r,c,10);const y=25,E=8;t.lineStyle(2,l,.5),t.beginPath(),t.moveTo(n+r-y,o-E),t.lineTo(n+r+E,o-E),t.lineTo(n+r+E,o+y),t.strokePath(),t.beginPath(),t.moveTo(n-E,o+c-y),t.lineTo(n-E,o+c+E),t.lineTo(n+y,o+c+E),t.strokePath(),t.lineStyle(1,9741240,.15),t.beginPath(),t.moveTo(n+20,o+2),t.lineTo(n+r-20,o+2),t.strokePath()}createButtonParticles(){var i;const t=this.BUTTON_Y_START,s=this.BUTTON_X+this.BUTTON_WIDTH/2;this.buttonParticles=this.add.particles(s,t,"particle",{speed:{min:20,max:40},angle:{min:0,max:360},scale:{start:.5,end:.2},alpha:{start:.8,end:0},lifespan:1500,frequency:80,quantity:1,tint:[12318672,12248829,4906624],blendMode:h.BlendModes.ADD,emitZone:{type:"edge",source:new h.Geom.Rectangle(-this.BUTTON_WIDTH/2-10,-this.BUTTON_HEIGHT/2-10,this.BUTTON_WIDTH+20,this.BUTTON_HEIGHT+20),quantity:32,yoyo:!1}}),this.buttonParticles.setDepth(8),(i=this.buttonParticles.postFX)==null||i.addGlow(16777215,2,0,!1,.3,8)}updateButtonParticles(){if(!this.buttonParticles)return;const t=this.BUTTON_Y_START+this.selectedIndex*this.BUTTON_SPACING,s=this.BUTTON_X+this.BUTTON_WIDTH/2;this.buttonParticles.setPosition(s,t)}drawButtonFrame(t,s,i,n,o,r){t.clear();const c=r?14742249:9741240,u=1976635,l=.1,y=r?3:2,E=4906624;if(r)for(let I=8;I>0;I--)t.lineStyle(I*2,E,.05),t.setDepth(15),t.strokeRoundedRect(s-I*2,i-I*2,n+I*4,o+I*4,8);t.fillStyle(u,l),t.fillRoundedRect(s,i,n,o,8),r&&(t.lineStyle(1,16777215,.2),t.beginPath(),t.moveTo(s+15,i+2),t.lineTo(s+n-15,i+2),t.strokePath()),t.lineStyle(y,c,1),t.strokeRoundedRect(s,i,n,o,8);const C=15,A=5;t.lineStyle(2,c,r?1:.7),t.beginPath(),t.moveTo(s-A,i+C),t.lineTo(s-A,i-A),t.lineTo(s+C,i-A),t.strokePath(),t.beginPath(),t.moveTo(s+n-C,i-A),t.lineTo(s+n+A,i-A),t.lineTo(s+n+A,i+C),t.strokePath(),t.beginPath(),t.moveTo(s-A,i+o-C),t.lineTo(s-A,i+o+A),t.lineTo(s+C,i+o+A),t.strokePath(),t.beginPath(),t.moveTo(s+n-C,i+o+A),t.lineTo(s+n+A,i+o+A),t.lineTo(s+n+A,i+o-C),t.strokePath(),r&&(t.lineStyle(4,E,.9),t.beginPath(),t.moveTo(s,i+15),t.lineTo(s,i+o-15),t.strokePath())}createJuanEntrance(){this.swooshGraphics=this.add.graphics(),this.swooshGraphics.setDepth(4),this.swooshGraphics.setAlpha(0);const t=-300,s=this.JUAN_FINAL_X,i=d/2+50;this.juanSprite=this.add.image(t,i,"juan-menu"),this.juanSprite.setScale(.55),this.juanSprite.setOrigin(.5,.5),this.juanSprite.setDepth(5),this.juanSprite.setAlpha(0),this.tweens.add({targets:[this.juanSprite,this.swooshGraphics],x:`+=${s-t}`,alpha:1,duration:800,ease:"Back.easeOut",easeParams:[1.5],onComplete:()=>{this.tweens.add({targets:this.juanSprite,y:i-10,duration:2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}})}setupKeyboardNavigation(){const t=this.input.keyboard;t&&(t.on("keydown-UP",()=>{this.canNavigate&&(this.selectedIndex=(this.selectedIndex-1+this.buttons.length)%this.buttons.length,this.updateSelection(),this.playSound("power-up-sfx",.4),this.canNavigate=!1,this.time.delayedCall(150,()=>{this.canNavigate=!0}))}),t.on("keydown-DOWN",()=>{this.canNavigate&&(this.selectedIndex=(this.selectedIndex+1)%this.buttons.length,this.updateSelection(),this.playSound("power-up-sfx",.4),this.canNavigate=!1,this.time.delayedCall(150,()=>{this.canNavigate=!0}))}),t.on("keydown-ENTER",()=>{this.playSound("punch-sfx",.5),this.buttons[this.selectedIndex].action()}))}updateSelection(){this.buttons.forEach((t,s)=>{const i=s===this.selectedIndex,n=this.BUTTON_Y_START+s*this.BUTTON_SPACING;this.drawButtonFrame(t.frame,this.BUTTON_X,n-this.BUTTON_HEIGHT/2,this.BUTTON_WIDTH,this.BUTTON_HEIGHT,i),i?t.text.setStroke("#4ade80",6):t.text.setStroke("#000000",6)}),this.updateButtonParticles()}createMuteButton(){const t=m-100,s=d-40,i=this.isMuted?"ðŸ”‡":"ðŸ”Š";this.muteButton=this.add.text(t,s,i,{fontFamily:"Arial",fontSize:"32px",color:"#cccccc",stroke:"#000000",strokeThickness:2}),this.muteButton.setOrigin(.5),this.muteButton.setDepth(20),this.muteButton.setInteractive({useHandCursor:!0}),this.muteButton.on("pointerover",()=>{var n;(n=this.muteButton)==null||n.setScale(1.2)}),this.muteButton.on("pointerout",()=>{var n;(n=this.muteButton)==null||n.setScale(1)}),this.muteButton.on("pointerdown",()=>{this.toggleMute(),this.playSound("punch-sfx",.3)})}toggleMute(){var t,s;this.isMuted=!this.isMuted,this.registry.set("musicMuted",this.isMuted),this.menuMusic&&(this.isMuted?(this.menuMusic.setVolume(0),(t=this.muteButton)==null||t.setText("ðŸ”‡")):(this.menuMusic.setVolume(.3),(s=this.muteButton)==null||s.setText("ðŸ”Š")))}startMenuMusic(){const t=this.sound.get("menu-music");if(t&&t.isPlaying){this.menuMusic=t,this.isMuted?this.menuMusic.setVolume(0):this.menuMusic.setVolume(.3);return}this.menuMusic=this.sound.add("menu-music",{volume:this.isMuted?0:.3,loop:!0}),this.menuMusic.play()}playSound(t,s=.5){this.sound.play(t,{volume:s})}startGame(){console.log("[MenuScene] Starting game..."),this.menuMusic&&this.menuMusic.isPlaying&&this.tweens.add({targets:this.menuMusic,volume:0,duration:300,onComplete:()=>{var t;(t=this.menuMusic)==null||t.stop()}}),this.cameras.main.fadeOut(400,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("Versus")})}}const T={MOVE_SPEED:300,ACCELERATION:1500,DRAG:1e3,JUMP_VELOCITY:-450,MAX_JUMPS:2,JUMP_BUFFER_TIME:150,FRAME_WIDTH:200,FRAME_HEIGHT:400,SCALE:.65,BODY_WIDTH:80,BODY_HEIGHT:200,CHAR_BOTTOM_PADDING:30,MAX_HEALTH:100,INVINCIBILITY_DURATION:500,KNOCKBACK_FORCE:250},B={PUNCH:10,UPPERCUT:20,AERIAL_PUNCH:15};class pe{constructor(e,t,s,i){a(this,"scene");a(this,"sprite");a(this,"inputManager");a(this,"jumpsRemaining",T.MAX_JUMPS);a(this,"currentState",0);a(this,"facingRight",!0);a(this,"COMBO_WINDOW",800);a(this,"COMBO_MIN_DELAY",250);a(this,"comboCount",0);a(this,"comboTimer",0);a(this,"comboDelayTimer",0);a(this,"bufferedAttack",null);a(this,"jumpBufferTimer",0);a(this,"maxHealth",T.MAX_HEALTH);a(this,"currentHealth",T.MAX_HEALTH);a(this,"isInvincible",!1);a(this,"invincibilityTimer",0);a(this,"healthBar",null);a(this,"currentAttackType",null);a(this,"isAnyEnemyShowingWarning",null);a(this,"getTimeUntilEnemyAttack",null);a(this,"counterDodgeQueued",!1);this.scene=e,this.inputManager=i,this.createAnimations(),this.sprite=e.physics.add.sprite(t,s,"juan-idle");const n=(T.FRAME_HEIGHT-T.CHAR_BOTTOM_PADDING)/T.FRAME_HEIGHT;this.sprite.setOrigin(.5,n),this.sprite.setScale(T.SCALE),this.setupPhysicsBody(),this.sprite.play("juan-idle")}createAnimations(){this.scene.anims.create({key:"juan-idle",frames:this.scene.anims.generateFrameNumbers("juan-idle",{start:0,end:5}),frameRate:8,repeat:-1}),this.scene.anims.create({key:"running-animation",frames:this.scene.anims.generateFrameNumbers("running-animation",{start:0,end:7}),frameRate:24,repeat:-1}),this.scene.anims.create({key:"juan-jump",frames:this.scene.anims.generateFrameNumbers("juan-jump",{start:0,end:3}),frameRate:10,repeat:0}),this.scene.anims.create({key:"juan-punch",frames:[{key:"juan-punch",frame:0},{key:"juan-punch",frame:1},{key:"juan-punch",frame:2},{key:"juan-punch",frame:3},{key:"juan-punch",frame:4},{key:"juan-punch",frame:5}],frameRate:12,repeat:0}),this.scene.anims.create({key:"juan-uppercut",frames:this.scene.anims.generateFrameNumbers("juan-uppercut",{start:0,end:4}),frameRate:14,repeat:0,yoyo:!0}),this.scene.anims.create({key:"juan-aerial-punch",frames:[{key:"juan-aerial-punch",frame:0},{key:"juan-aerial-punch",frame:"windup"},{key:"juan-aerial-punch",frame:"punch"},{key:"juan-aerial-punch",frame:5}],frameRate:12,repeat:0}),this.scene.anims.create({key:"juan-getting-punched",frames:this.scene.anims.generateFrameNumbers("juan-getting-punched",{start:0,end:4}),frameRate:18,repeat:0,yoyo:!0}),this.scene.anims.create({key:"juan-getting-punched-stomach",frames:this.scene.anims.generateFrameNumbers("juan-getting-punched-stomach",{start:0,end:4}),frameRate:18,repeat:0,yoyo:!0}),this.scene.anims.create({key:"juan-dodge",frames:this.scene.anims.generateFrameNumbers("juan-dodge",{start:0,end:3}),frameRate:14,repeat:0,yoyo:!0}),this.scene.anims.create({key:"juan-matrix-dodge",frames:[{key:"juan-matrix-dodge",frame:0},{key:"juan-matrix-dodge",frame:1},{key:"juan-matrix-dodge",frame:2},{key:"juan-matrix-dodge",frame:"lean_deep"},{key:"juan-matrix-dodge",frame:"crouch_1"}],frameRate:14,repeat:0,yoyo:!0}),this.scene.anims.create({key:"juan-kipup",frames:this.scene.anims.generateFrameNumbers("juan-kipup",{start:0,end:10}),frameRate:16,repeat:0})}setupPhysicsBody(){const e=this.sprite.body;e.setSize(T.BODY_WIDTH,T.BODY_HEIGHT);const t=(T.FRAME_WIDTH-T.BODY_WIDTH)/2,s=T.FRAME_HEIGHT-T.CHAR_BOTTOM_PADDING-T.BODY_HEIGHT;e.setOffset(t,s),e.setCollideWorldBounds(!0),e.setMaxVelocity(T.MOVE_SPEED,800),e.setDrag(T.DRAG,0)}update(){if(!this.scene.registry.get("matchStarted"))return;const e=this.scene.game.loop.delta;this.comboTimer>0&&(this.comboTimer-=e,this.comboTimer<=0&&(this.comboCount=0)),this.comboDelayTimer>0&&(this.comboDelayTimer-=e),this.invincibilityTimer>0&&(this.invincibilityTimer-=e,this.invincibilityTimer<=0&&(this.isInvincible=!1)),this.handleDebugHurt(),this.handleCounterDodge(),this.handleDodge(),this.handleMatrixDodge(),this.handleAttack(),this.handleMovement(),this.handleJump(),this.updateState(),this.updateFacing()}handleDebugHurt(){this.inputManager.isDebugHurtPressed()&&this.triggerHurt(),this.inputManager.isDebugHurtStomachPressed()&&this.triggerHurtStomach()}triggerHurt(){this.currentState!==5&&(this.currentState=5,this.sprite.play("juan-getting-punched"),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("juan-idle")}))}triggerHurtStomach(){this.currentState!==5&&(this.currentState=5,this.sprite.play("juan-getting-punched-stomach"),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("juan-idle")}))}handleDodge(){this.currentState===7||this.currentState===4||this.currentState===5||this.inputManager.isDodgePressed()&&this.performDodge()}performDodge(){this.currentState=7,this.sprite.play("juan-dodge"),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("juan-idle")})}handleMatrixDodge(){this.currentState===7||this.currentState===4||this.currentState===5||this.inputManager.isMatrixDodgePressed()&&this.performMatrixDodge()}performMatrixDodge(){this.currentState=7,this.sprite.play("juan-matrix-dodge"),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("juan-idle")})}setEnemyWarningChecker(e,t){this.isAnyEnemyShowingWarning=e,this.getTimeUntilEnemyAttack=t}handleCounterDodge(){var e;this.currentState===7||this.currentState===4||this.currentState===5||this.counterDodgeQueued||this.inputManager.isCounterDodgePressed()&&(((e=this.isAnyEnemyShowingWarning)==null?void 0:e.call(this))??!1?this.queueCounterDodge():this.performCounterDodge(!1,0))}queueCounterDodge(){var t;const e=((t=this.getTimeUntilEnemyAttack)==null?void 0:t.call(this))??0;this.counterDodgeQueued=!0,this.isInvincible=!0,this.invincibilityTimer=e+600,e>0?this.scene.time.delayedCall(e,()=>{this.performCounterDodge(!0,0)}):this.performCounterDodge(!0,0)}performCounterDodge(e,t){this.currentState=7,this.counterDodgeQueued=!1;const s=["juan-dodge","juan-matrix-dodge","juan-kipup"],i=Math.floor(Math.random()*s.length),n=s[i];this.sprite.play(n),e&&this.scene.tweens.add({targets:this.sprite,scaleX:T.SCALE*1.05,scaleY:T.SCALE*1.05,duration:100,yoyo:!0,ease:"Sine.easeInOut"}),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("juan-idle")})}handleAttack(){if(this.currentState===5)return;const e=this.inputManager.isPunchPressed(),t=this.inputManager.isUppercutPressed(),s=this.currentState===4,i=!this.isOnGround();if(i&&!s&&e){this.performAerialPunch();return}if(e&&this.comboCount===1&&this.comboDelayTimer<=0){this.bufferedAttack=null,this.performUppercut(),this.comboCount=0,this.comboTimer=0;return}if(s){e?this.bufferedAttack=i?"aerial-punch":"punch":t&&(this.bufferedAttack="uppercut");return}if(t){this.performUppercut();return}if(e){this.performPunch();return}}onAttackComplete(){if(this.bufferedAttack){const e=this.bufferedAttack;switch(this.bufferedAttack=null,e){case"punch":this.performPunch();break;case"uppercut":this.performUppercut();break;case"aerial-punch":this.performAerialPunch();break}}else this.currentState=0,this.sprite.play("juan-idle")}performPunch(){this.currentState=4,this.currentAttackType="punch",this.sprite.play("juan-punch"),this.scene.sound.play("punch-sfx",{volume:.5}),this.comboCount=1,this.comboTimer=this.COMBO_WINDOW,this.comboDelayTimer=this.COMBO_MIN_DELAY,this.sprite.once("animationcomplete",()=>{this.currentAttackType=null,this.onAttackComplete()})}performUppercut(){this.currentState=4,this.currentAttackType="uppercut",this.sprite.play("juan-uppercut"),this.scene.sound.play("punch-sfx",{volume:.6}),this.sprite.once("animationcomplete",()=>{this.currentAttackType=null,this.onAttackComplete()})}performAerialPunch(){this.currentState=4,this.currentAttackType="aerial-punch",this.sprite.play("juan-aerial-punch"),this.scene.sound.play("punch-sfx",{volume:.6}),this.sprite.once("animationcomplete",()=>{this.currentAttackType=null,this.onAttackComplete()})}handleMovement(){const e=this.sprite.body;if(this.currentState===4||this.currentState===5||this.currentState===7){e.setAccelerationX(0);return}this.inputManager.isMovingLeft()?(e.setAccelerationX(-1500),this.facingRight=!1):this.inputManager.isMovingRight()?(e.setAccelerationX(T.ACCELERATION),this.facingRight=!0):e.setAccelerationX(0)}handleJump(){const e=this.sprite.body,t=this.scene.game.loop.delta;this.jumpBufferTimer>0&&(this.jumpBufferTimer-=t),this.inputManager.isJumpPressed()&&(this.jumpBufferTimer=T.JUMP_BUFFER_TIME),e.blocked.down&&(this.jumpsRemaining=T.MAX_JUMPS),this.jumpBufferTimer>0&&this.jumpsRemaining>0&&(e.setVelocityY(T.JUMP_VELOCITY),this.jumpsRemaining--,this.jumpBufferTimer=0)}updateState(){if(this.currentState===4||this.currentState===5||this.currentState===7)return;const e=this.sprite.body,t=this.currentState;e.blocked.down?this.currentState=Math.abs(e.velocity.x)>10?1:0:this.currentState=e.velocity.y<0?2:3,this.currentState!==t&&this.playAnimationForState()}playAnimationForState(){var e,t,s;switch(this.currentState){case 0:((e=this.sprite.anims.currentAnim)==null?void 0:e.key)!=="juan-idle"&&this.sprite.play("juan-idle");break;case 1:((t=this.sprite.anims.currentAnim)==null?void 0:t.key)!=="running-animation"&&this.sprite.play("running-animation");break;case 2:case 3:((s=this.sprite.anims.currentAnim)==null?void 0:s.key)!=="juan-jump"&&this.sprite.play("juan-jump");break}}updateFacing(){const e=!this.facingRight;this.sprite.flipX!==e&&this.sprite.setFlipX(e)}getSprite(){return this.sprite}getState(){return this.currentState}isOnGround(){return this.sprite.body.blocked.down}takeDamage(e,t){if(this.isInvincible||this.currentHealth<=0)return;this.currentHealth=Math.max(0,this.currentHealth-e),this.healthBar&&this.healthBar.updateHealth(this.currentHealth);const s=this.sprite.body,i=this.sprite.x<t?-1:1;s.setVelocityX(i*T.KNOCKBACK_FORCE),this.isInvincible=!0,this.invincibilityTimer=T.INVINCIBILITY_DURATION,this.triggerHurt(),this.currentHealth<=0&&(this.currentState=6,s.setVelocity(0,0),s.setAcceleration(0,0))}getAttackHitbox(){if(this.currentState!==4||!this.currentAttackType)return null;const e=this.sprite.anims.currentAnim;if(!e)return null;const s=this.sprite.anims.currentFrame;if(!s)return null;let i=80,n=60,o=this.facingRight?50:-50,r=-30;switch(this.currentAttackType){case"punch":if(e.key==="juan-punch"&&s.index>=2&&s.index<=3)i=100,o=this.facingRight?60:-60;else return null;break;case"uppercut":if(e.key==="juan-uppercut"&&s.index>=1&&s.index<=3)i=70,n=80,o=this.facingRight?40:-40,r=-50;else return null;break;case"aerial-punch":if(e.key==="juan-aerial-punch"&&(s.frame.name==="windup"||s.frame.name==="punch"))i=100,o=this.facingRight?60:-60;else return null;break}const c=this.sprite.x+o-i/2,u=this.sprite.y+r-n/2;return new h.Geom.Rectangle(c,u,i,n)}getAttackDamage(){if(!this.currentAttackType)return 0;switch(this.currentAttackType){case"punch":return B.PUNCH;case"uppercut":return B.UPPERCUT;case"aerial-punch":return B.AERIAL_PUNCH;default:return 0}}getAttackType(){return this.currentAttackType}setHealthBar(e){this.healthBar=e}getCurrentHealth(){return this.currentHealth}getMaxHealth(){return this.maxHealth}isDead(){return this.currentHealth<=0}getIsInvincible(){return this.isInvincible}}const b={FRAME_WIDTH:200,FRAME_HEIGHT:400,SCALE:.8,BODY_WIDTH:100,BODY_HEIGHT:220,MOVE_SPEED:250,ACCELERATION:1200,DRAG:800,JUMP_VELOCITY:-650,MAX_HEALTH:300,INVINCIBILITY_DURATION:800,KNOCKBACK_FORCE:250,ATTACK_WARNING_DURATION:500};class fe{constructor(e,t,s,i){a(this,"scene");a(this,"sprite");a(this,"inputManager");a(this,"currentState",0);a(this,"facingRight",!1);a(this,"maxHealth",b.MAX_HEALTH);a(this,"currentHealth",b.MAX_HEALTH);a(this,"isInvincible",!1);a(this,"invincibilityTimer",0);a(this,"healthBar",null);a(this,"currentAttackType",null);a(this,"warningContainer",null);a(this,"warningGraphics",null);a(this,"warningText",null);a(this,"pendingAttack",null);a(this,"warningTween",null);a(this,"attackExecuteTime",0);a(this,"aiMovementDirection",0);a(this,"aiJumpRequested",!1);a(this,"targetX",null);this.scene=e,this.inputManager=i,this.createAnimations(),this.sprite=e.physics.add.sprite(t,s,"enemy-idle"),this.sprite.setOrigin(.5,1),this.sprite.setScale(b.SCALE),this.setupPhysicsBody(),this.createWarningIndicator(),this.sprite.play("enemy-idle")}createWarningIndicator(){this.warningContainer=this.scene.add.container(this.sprite.x,this.sprite.y-180),this.warningContainer.setDepth(100),this.warningContainer.setVisible(!1),this.warningGraphics=this.scene.add.graphics(),this.warningGraphics.fillStyle(16711680,.15),this.warningGraphics.fillCircle(0,0,35),this.warningGraphics.fillStyle(16711680,.25),this.warningGraphics.fillCircle(0,0,28),this.warningGraphics.fillStyle(16724736,.4),this.warningGraphics.fillCircle(0,0,22),this.warningGraphics.fillStyle(16733440,.6),this.warningGraphics.fillCircle(0,0,16),this.warningGraphics.fillStyle(16711680,1),this.warningGraphics.fillCircle(0,0,12),this.warningText=this.scene.add.text(0,0,"!",{fontFamily:"Quantico, Arial",fontSize:"24px",fontStyle:"bold",color:"#ffffff",stroke:"#000000",strokeThickness:2}),this.warningText.setOrigin(.5,.5),this.warningContainer.add([this.warningGraphics,this.warningText])}createAnimations(){this.scene.anims.exists("enemy-idle")||this.scene.anims.create({key:"enemy-idle",frames:this.scene.anims.generateFrameNumbers("enemy-idle",{start:0,end:2}),frameRate:6,repeat:-1}),this.scene.anims.exists("enemy-running")||this.scene.anims.create({key:"enemy-running",frames:this.scene.anims.generateFrameNumbers("enemy-running",{start:0,end:7}),frameRate:12,repeat:-1}),this.scene.anims.exists("enemy-punch")||this.scene.anims.create({key:"enemy-punch",frames:[{key:"enemy-punch",frame:0},{key:"enemy-punch",frame:1},{key:"enemy-punch",frame:2},{key:"enemy-punch",frame:"punch_extend"}],frameRate:12,repeat:0}),this.scene.anims.exists("enemy-sidekick")||this.scene.anims.create({key:"enemy-sidekick",frames:[{key:"enemy-sidekick",frame:0},{key:"enemy-sidekick",frame:1},{key:"enemy-sidekick",frame:2},{key:"enemy-sidekick",frame:"kick_extend"},{key:"enemy-sidekick",frame:"kick_follow"}],frameRate:18,repeat:0,yoyo:!0}),this.scene.anims.exists("enemy-getting-punched")||this.scene.anims.create({key:"enemy-getting-punched",frames:[{key:"enemy-getting-punched",frame:0},{key:"enemy-getting-punched",frame:1},{key:"enemy-getting-punched",frame:2},{key:"enemy-getting-punched",frame:3}],frameRate:18,repeat:0,yoyo:!0})}setupPhysicsBody(){const e=this.sprite.body;e.setSize(b.BODY_WIDTH,b.BODY_HEIGHT);const t=(b.FRAME_WIDTH-b.BODY_WIDTH)/2,i=b.FRAME_HEIGHT-b.BODY_HEIGHT-30;e.setOffset(t,i),e.setCollideWorldBounds(!0),e.setMaxVelocity(b.MOVE_SPEED,800),e.setDrag(b.DRAG,0)}update(){if(!this.scene.registry.get("matchStarted"))return;const e=this.scene.game.loop.delta;this.invincibilityTimer>0&&(this.invincibilityTimer-=e,this.invincibilityTimer<=0&&(this.isInvincible=!1)),this.updateWarningPosition(),!(this.currentHealth<=0)&&(this.handleAttack(),this.handleMovement(),this.handleJump(),this.updateState(),this.updateFacing())}updateWarningPosition(){this.warningContainer&&this.warningContainer.setPosition(this.sprite.x,this.sprite.y-180)}handleAttack(){this.currentState===4||this.currentState===5||this.currentHealth<=0||this.isShowingWarning()||(this.inputManager.isEnemyPunchPressed()?this.punch():this.inputManager.isEnemySidekickPressed()&&this.sidekick())}performPunch(){this.currentState=4,this.currentAttackType="punch",this.sprite.play("enemy-punch"),this.scene.sound.play("punch-sfx",{volume:.5}),this.sprite.once("animationcomplete",()=>{this.currentAttackType=null,this.currentState=0,this.sprite.play("enemy-idle")})}performSidekick(){this.currentState=4,this.currentAttackType="sidekick",this.sprite.play("enemy-sidekick"),this.scene.sound.play("kick-sfx",{volume:.5}),this.sprite.once("animationcomplete",()=>{this.currentAttackType=null,this.currentState=0,this.sprite.play("enemy-idle")})}handleMovement(){const e=this.sprite.body;if(this.currentState===5||this.currentState===4){e.setAccelerationX(0);return}if(this.targetX!==null&&(this.aiMovementDirection===-1&&this.sprite.x<=this.targetX||this.aiMovementDirection===1&&this.sprite.x>=this.targetX)){this.aiMovementDirection=0,this.targetX=null,e.setAccelerationX(0),e.setVelocityX(0);return}const t=this.inputManager.isEnemyMovingLeft()||this.aiMovementDirection===-1,s=this.inputManager.isEnemyMovingRight()||this.aiMovementDirection===1;t?(e.setAccelerationX(-1200),this.facingRight=!1):s?(e.setAccelerationX(b.ACCELERATION),this.facingRight=!0):e.setAccelerationX(0)}handleJump(){const e=this.sprite.body,t=this.inputManager.isEnemyJumpPressed()||this.aiJumpRequested;this.aiJumpRequested&&(this.aiJumpRequested=!1),t&&e.blocked.down&&e.setVelocityY(b.JUMP_VELOCITY)}updateState(){if(this.currentState===4||this.currentState===5)return;const e=this.sprite.body,t=this.currentState;e.blocked.down?this.currentState=Math.abs(e.velocity.x)>10?1:0:this.currentState=e.velocity.y<0?2:3,this.currentState!==t&&this.playAnimationForState()}playAnimationForState(){var e,t,s;switch(this.currentState){case 0:((e=this.sprite.anims.currentAnim)==null?void 0:e.key)!=="enemy-idle"&&this.sprite.play("enemy-idle");break;case 1:((t=this.sprite.anims.currentAnim)==null?void 0:t.key)!=="enemy-running"&&this.sprite.play("enemy-running");break;case 2:case 3:((s=this.sprite.anims.currentAnim)==null?void 0:s.key)!=="enemy-idle"&&this.sprite.play("enemy-idle");break}}updateFacing(){const e=!this.facingRight;this.sprite.flipX!==e&&this.sprite.setFlipX(e)}showAttackWarning(e,t){if(!this.warningContainer||!this.warningGraphics){t();return}this.pendingAttack=e,this.warningContainer.setVisible(!0),this.warningContainer.setAlpha(0),this.warningContainer.setScale(.5),this.attackExecuteTime=this.scene.time.now+b.ATTACK_WARNING_DURATION,this.warningTween&&this.warningTween.destroy(),this.warningTween=this.scene.tweens.add({targets:this.warningContainer,alpha:{from:0,to:1},scale:{from:.5,to:1.2},duration:b.ATTACK_WARNING_DURATION/2,yoyo:!0,repeat:0,ease:"Sine.easeInOut",onUpdate:()=>{if(this.warningContainer){const s=(Math.random()-.5)*4;this.warningContainer.x=this.sprite.x+s}},onComplete:()=>{this.hideAttackWarning(),t()}}),this.scene.tweens.add({targets:this.sprite,tint:{from:16777215,to:16737894},duration:b.ATTACK_WARNING_DURATION/3,yoyo:!0,repeat:1,onComplete:()=>{this.sprite.clearTint()}})}hideAttackWarning(){this.warningContainer&&(this.warningContainer.setVisible(!1),this.warningContainer.setPosition(this.sprite.x,this.sprite.y-180)),this.pendingAttack=null,this.warningTween&&(this.warningTween.destroy(),this.warningTween=null)}isShowingWarning(){return this.pendingAttack!==null}getTimeUntilAttack(){return this.isShowingWarning()?Math.max(0,this.attackExecuteTime-this.scene.time.now):0}getSprite(){return this.sprite}getState(){return this.currentState}setFacing(e){this.facingRight=e,this.sprite.setFlipX(!e)}takeDamage(e,t,s){if(this.isInvincible||this.currentHealth<=0)return;this.currentHealth=Math.max(0,this.currentHealth-e),this.healthBar&&this.healthBar.updateHealth(this.currentHealth);const i=this.sprite.body,n=this.sprite.x<t?-1:1;i.setVelocityX(n*b.KNOCKBACK_FORCE),this.isInvincible=!0,this.invincibilityTimer=b.INVINCIBILITY_DURATION,s&&this.triggerHurt(),this.currentHealth<=0&&(i.setVelocity(0,0),i.setAcceleration(0,0))}triggerHurt(){this.currentState!==5&&(this.currentState=5,this.currentAttackType=null,this.sprite.play("enemy-getting-punched"),this.sprite.once("animationcomplete",()=>{this.currentState=0,this.sprite.play("enemy-idle")}))}setHealthBar(e){this.healthBar=e}getCurrentHealth(){return this.currentHealth}getMaxHealth(){return this.maxHealth}isDead(){return this.currentHealth<=0}getIsInvincible(){return this.isInvincible}getAttackHitbox(){if(this.currentState!==4||!this.currentAttackType)return null;const e=this.sprite.anims.currentAnim;if(!e)return null;const s=this.sprite.anims.currentFrame;if(!s)return null;if(e.key==="enemy-punch"&&s.frame.name==="punch_extend"){const o=this.facingRight?70:-70,r=-30,c=this.sprite.x+o-100/2,u=this.sprite.y+r-60/2;return new h.Geom.Rectangle(c,u,100,60)}if(e.key==="enemy-sidekick"&&(s.frame.name==="kick_extend"||s.frame.name==="kick_follow")){const o=this.facingRight?90:-90,r=-40,c=this.sprite.x+o-120/2,u=this.sprite.y+r-80/2;return new h.Geom.Rectangle(c,u,120,80)}return null}getAttackDamage(){return this.currentAttackType==="punch"?10:this.currentAttackType==="sidekick"?15:0}canAttack(){return this.currentState!==4&&this.currentState!==5&&this.currentHealth>0&&!this.isShowingWarning()}canJump(){return this.sprite.body.blocked.down&&this.currentHealth>0}punch(){return!this.canAttack()||this.isShowingWarning()?!1:(this.showAttackWarning("punch",()=>{this.canAttack()&&this.performPunch()}),!0)}sidekick(){return!this.canAttack()||this.isShowingWarning()?!1:(this.showAttackWarning("sidekick",()=>{this.canAttack()&&this.performSidekick()}),!0)}jump(){return this.canJump()?(this.aiJumpRequested=!0,!0):!1}startMovingLeft(){this.aiMovementDirection=-1}startMovingRight(){this.aiMovementDirection=1}stopMoving(){this.aiMovementDirection=0,this.targetX=null}moveLeftBy(e){this.targetX=this.sprite.x-e,this.aiMovementDirection=-1}moveRightBy(e){this.targetX=this.sprite.x+e,this.aiMovementDirection=1}getAIMovementDirection(){return this.aiMovementDirection}isAttacking(){return this.currentState===4}getX(){return this.sprite.x}getY(){return this.sprite.y}isFacingRight(){return this.facingRight}}const _={SCALE:.15,BOB_AMPLITUDE:8,BOB_SPEED:2e3,GLOW_SPEED:1500,BOOST_DURATION:1e4,POWER_SCALE:1.2},R=class R{constructor(e,t,s){a(this,"scene");a(this,"sprite");a(this,"startY");a(this,"bobTween");a(this,"glowTween");a(this,"isCollected",!1);this.scene=e,this.startY=s,this.sprite=e.physics.add.sprite(t,s,"power-booster"),this.sprite.setScale(_.SCALE),this.sprite.setDepth(5);const i=this.sprite.body;i.setAllowGravity(!1),i.setCircle(this.sprite.width*.3,this.sprite.width*.2,this.sprite.height*.2),this.createFloatingAnimation(),this.createGlowEffect()}createFloatingAnimation(){this.bobTween=this.scene.tweens.add({targets:this.sprite,y:this.startY-_.BOB_AMPLITUDE,duration:_.BOB_SPEED/2,ease:"Sine.easeInOut",yoyo:!0,repeat:-1})}createGlowEffect(){this.glowTween=this.scene.tweens.add({targets:this.sprite,alpha:{from:.8,to:1},duration:_.GLOW_SPEED/2,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.scene.tweens.add({targets:this.sprite,scaleX:_.SCALE*1.1,scaleY:_.SCALE*1.1,duration:_.GLOW_SPEED,ease:"Sine.easeInOut",yoyo:!0,repeat:-1})}collect(e,t){this.isCollected||R.isPlayerPoweredUp||(this.isCollected=!0,this.bobTween.stop(),this.glowTween.stop(),this.scene.sound.play("power-up-sfx",{volume:.7}),t&&t.activate(_.BOOST_DURATION),this.scene.tweens.add({targets:this.sprite,scale:_.SCALE*2,alpha:0,duration:300,ease:"Power2",onComplete:()=>{this.sprite.destroy()}}),this.applyPowerBoost(e),this.createCollectionParticles())}applyPowerBoost(e){const t=e.scaleX,s=e.scaleY;R.isPlayerPoweredUp=!0,this.scene.tweens.add({targets:e,scaleX:t*_.POWER_SCALE,scaleY:s*_.POWER_SCALE,duration:300,ease:"Back.easeOut"}),e.setTint(65535),this.scene.tweens.add({targets:e,alpha:{from:.5,to:1},duration:100,repeat:3,yoyo:!0,onComplete:()=>{e.setAlpha(1)}}),this.scene.time.delayedCall(_.BOOST_DURATION,()=>{this.scene.tweens.add({targets:e,scaleX:t,scaleY:s,duration:500,ease:"Power2"}),e.clearTint(),R.isPlayerPoweredUp=!1})}createCollectionParticles(){const e=this.scene.add.particles(this.sprite.x,this.sprite.y,"power-booster",{scale:{start:.05,end:0},speed:{min:50,max:150},angle:{min:0,max:360},lifespan:500,quantity:8,blendMode:"ADD"});e.explode(8),this.scene.time.delayedCall(600,()=>{e.destroy()})}getSprite(){return this.sprite}isAlreadyCollected(){return this.isCollected}static getBoostDuration(){return _.BOOST_DURATION}static getPowerScale(){return _.POWER_SCALE}static resetState(){R.isPlayerPoweredUp=!1}};a(R,"isPlayerPoweredUp",!1);let w=R;class ye{constructor(e){a(this,"scene");a(this,"cursors");a(this,"wasd");a(this,"spaceKey");a(this,"punchKey");a(this,"uppercutKey");a(this,"kickKey");a(this,"sidekickKey");a(this,"interactKey");a(this,"debugHurtKey");a(this,"debugHurtStomachKey");a(this,"dodgeKey");a(this,"matrixDodgeKey");a(this,"counterDodgeKey");a(this,"enemyJumpKey");a(this,"enemyLeftKey");a(this,"enemyRightKey");a(this,"enemyCrouchKey");a(this,"enemyPunchKey");a(this,"enemySidekickKey");this.scene=e,this.setupKeyboardInput()}setupKeyboardInput(){const e=this.scene.input.keyboard;e&&(this.cursors=e.createCursorKeys(),this.wasd={W:e.addKey(h.Input.Keyboard.KeyCodes.W),A:e.addKey(h.Input.Keyboard.KeyCodes.A),S:e.addKey(h.Input.Keyboard.KeyCodes.S),D:e.addKey(h.Input.Keyboard.KeyCodes.D)},this.spaceKey=e.addKey(h.Input.Keyboard.KeyCodes.SPACE),this.punchKey=e.addKey(h.Input.Keyboard.KeyCodes.C),this.uppercutKey=e.addKey(h.Input.Keyboard.KeyCodes.V),this.kickKey=e.addKey(h.Input.Keyboard.KeyCodes.X),this.sidekickKey=e.addKey(h.Input.Keyboard.KeyCodes.Z),this.interactKey=e.addKey(h.Input.Keyboard.KeyCodes.E),this.debugHurtKey=e.addKey(h.Input.Keyboard.KeyCodes.P),this.debugHurtStomachKey=e.addKey(h.Input.Keyboard.KeyCodes.O),this.dodgeKey=e.addKey(h.Input.Keyboard.KeyCodes.I),this.matrixDodgeKey=e.addKey(h.Input.Keyboard.KeyCodes.L),this.counterDodgeKey=e.addKey(h.Input.Keyboard.KeyCodes.U),this.enemyJumpKey=e.addKey(h.Input.Keyboard.KeyCodes.Y),this.enemyLeftKey=e.addKey(h.Input.Keyboard.KeyCodes.G),this.enemyRightKey=e.addKey(h.Input.Keyboard.KeyCodes.J),this.enemyCrouchKey=e.addKey(h.Input.Keyboard.KeyCodes.H),this.enemyPunchKey=e.addKey(h.Input.Keyboard.KeyCodes.U),this.enemySidekickKey=e.addKey(h.Input.Keyboard.KeyCodes.K))}isMovingLeft(){var e,t;return((e=this.cursors)==null?void 0:e.left.isDown)||((t=this.wasd)==null?void 0:t.A.isDown)||!1}isMovingRight(){var e,t;return((e=this.cursors)==null?void 0:e.right.isDown)||((t=this.wasd)==null?void 0:t.D.isDown)||!1}isMovingUp(){var e,t;return((e=this.cursors)==null?void 0:e.up.isDown)||((t=this.wasd)==null?void 0:t.W.isDown)||!1}isMovingDown(){var e,t;return((e=this.cursors)==null?void 0:e.down.isDown)||((t=this.wasd)==null?void 0:t.S.isDown)||!1}isJumpPressed(){var e,t;return h.Input.Keyboard.JustDown(this.spaceKey)||h.Input.Keyboard.JustDown((e=this.cursors)==null?void 0:e.up)||h.Input.Keyboard.JustDown((t=this.wasd)==null?void 0:t.W)}isJumpHeld(){var e,t,s;return((e=this.spaceKey)==null?void 0:e.isDown)||((t=this.cursors)==null?void 0:t.up.isDown)||((s=this.wasd)==null?void 0:s.W.isDown)||!1}isPunchPressed(){return h.Input.Keyboard.JustDown(this.punchKey)}isUppercutPressed(){return h.Input.Keyboard.JustDown(this.uppercutKey)}isKickPressed(){return h.Input.Keyboard.JustDown(this.kickKey)}isSidekickPressed(){return h.Input.Keyboard.JustDown(this.sidekickKey)}isInteractPressed(){return h.Input.Keyboard.JustDown(this.interactKey)}isDebugHurtPressed(){return h.Input.Keyboard.JustDown(this.debugHurtKey)}isDebugHurtStomachPressed(){return h.Input.Keyboard.JustDown(this.debugHurtStomachKey)}isDodgePressed(){return h.Input.Keyboard.JustDown(this.dodgeKey)}isMatrixDodgePressed(){return h.Input.Keyboard.JustDown(this.matrixDodgeKey)}isCounterDodgePressed(){return h.Input.Keyboard.JustDown(this.counterDodgeKey)}getHorizontalAxis(){let e=0;return this.isMovingLeft()&&(e-=1),this.isMovingRight()&&(e+=1),e}isEnemyMovingLeft(){var e;return((e=this.enemyLeftKey)==null?void 0:e.isDown)||!1}isEnemyMovingRight(){var e;return((e=this.enemyRightKey)==null?void 0:e.isDown)||!1}isEnemyJumpPressed(){return h.Input.Keyboard.JustDown(this.enemyJumpKey)}isEnemyCrouchPressed(){var e;return((e=this.enemyCrouchKey)==null?void 0:e.isDown)||!1}isEnemyPunchPressed(){return h.Input.Keyboard.JustDown(this.enemyPunchKey)}isEnemySidekickPressed(){return h.Input.Keyboard.JustDown(this.enemySidekickKey)}}const g={WIDTH:200,HEIGHT:20,MARGIN_X:40,MARGIN_Y:40,BG_COLOR:1710638,BORDER_COLOR:4868714,GLOW_COLOR:65535,PULSE_SPEED:800,BORDER_RADIUS:10};class ge{constructor(e){a(this,"scene");a(this,"container");a(this,"background");a(this,"fillBar");a(this,"border");a(this,"glowEffect");a(this,"icon");a(this,"label");a(this,"timerText");a(this,"currentProgress",1);a(this,"targetProgress",1);a(this,"isActive",!1);a(this,"duration",0);a(this,"elapsed",0);a(this,"pulseTween",null);this.scene=e;const t=e.cameras.main.width-g.WIDTH-g.MARGIN_X-40,s=g.MARGIN_Y;this.container=e.add.container(t,s),this.container.setScrollFactor(0),this.container.setDepth(1e3),this.container.setAlpha(0),this.glowEffect=e.add.graphics(),this.container.add(this.glowEffect),this.background=e.add.graphics(),this.drawBackground(),this.container.add(this.background),this.fillBar=e.add.graphics(),this.container.add(this.fillBar),this.border=e.add.graphics(),this.drawBorder(),this.container.add(this.border),this.icon=e.add.image(-25,g.HEIGHT/2,"power-booster"),this.icon.setScale(.04),this.container.add(this.icon),this.label=e.add.text(g.WIDTH/2,-8,"POWER BOOST",{fontFamily:"monospace",fontSize:"10px",color:"#00ffff",fontStyle:"bold"}),this.label.setOrigin(.5,1),this.container.add(this.label),this.timerText=e.add.text(g.WIDTH/2,g.HEIGHT/2,"",{fontFamily:"monospace",fontSize:"12px",color:"#ffffff",fontStyle:"bold"}),this.timerText.setOrigin(.5,.5),this.container.add(this.timerText),e.events.on("update",this.update,this)}drawBackground(){this.background.clear(),this.background.fillStyle(g.BG_COLOR,.9),this.background.fillRoundedRect(0,0,g.WIDTH,g.HEIGHT,g.BORDER_RADIUS)}drawBorder(){this.border.clear(),this.border.lineStyle(2,g.BORDER_COLOR,1),this.border.strokeRoundedRect(0,0,g.WIDTH,g.HEIGHT,g.BORDER_RADIUS)}drawFill(e){if(this.fillBar.clear(),e<=0)return;const t=Math.max(0,(g.WIDTH-4)*e),s=this.getGradientColor(e);this.fillBar.fillStyle(s,1),this.fillBar.fillRoundedRect(2,2,t,g.HEIGHT-4,g.BORDER_RADIUS-2),this.fillBar.fillStyle(16777215,.3),this.fillBar.fillRoundedRect(2,2,t,(g.HEIGHT-4)/3,{tl:g.BORDER_RADIUS-2,tr:g.BORDER_RADIUS-2,bl:0,br:0})}drawGlow(e){if(this.glowEffect.clear(),e<=0)return;const t=(g.WIDTH-4)*e;this.glowEffect.fillStyle(g.GLOW_COLOR,.2),this.glowEffect.fillRoundedRect(-4,-4,t+8,g.HEIGHT+8,g.BORDER_RADIUS+2)}getGradientColor(e){return e>.6?65535:e>.3?16776960:16729156}activate(e){this.duration=e,this.elapsed=0,this.currentProgress=1,this.targetProgress=1,this.isActive=!0,this.scene.tweens.add({targets:this.container,alpha:1,duration:300,ease:"Power2"}),this.startPulseAnimation(),this.scene.tweens.add({targets:this.icon,scale:{from:.08,to:.04},duration:400,ease:"Back.easeOut"})}deactivate(){this.isActive=!1,this.pulseTween&&(this.pulseTween.stop(),this.pulseTween=null),this.scene.tweens.add({targets:this.container,alpha:0,duration:500,ease:"Power2"})}startPulseAnimation(){this.pulseTween=this.scene.tweens.add({targets:this.glowEffect,alpha:{from:.5,to:1},duration:g.PULSE_SPEED,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.scene.tweens.add({targets:this.icon,scale:{from:.04,to:.045},duration:g.PULSE_SPEED,ease:"Sine.easeInOut",yoyo:!0,repeat:-1})}update(e,t){if(!this.isActive)return;this.elapsed+=t,this.targetProgress=Math.max(0,1-this.elapsed/this.duration),this.currentProgress+=(this.targetProgress-this.currentProgress)*.1,this.drawFill(this.currentProgress),this.drawGlow(this.currentProgress);const s=Math.ceil((this.duration-this.elapsed)/1e3);this.timerText.setText(`${Math.max(0,s)}s`),this.currentProgress<=.3?(this.label.setColor("#ff4444"),this.timerText.setColor("#ff4444")):this.currentProgress<=.6?(this.label.setColor("#ffff00"),this.timerText.setColor("#ffff00")):(this.label.setColor("#00ffff"),this.timerText.setColor("#ffffff")),this.elapsed>=this.duration&&this.deactivate()}getIsActive(){return this.isActive}destroy(){this.scene.events.off("update",this.update,this),this.container.destroy()}}const p={OVERLAY_COLOR:0,OVERLAY_ALPHA:.6,PANEL_WIDTH:420,PANEL_HEIGHT:420,PANEL_COLOR:1976635,PANEL_BORDER_COLOR:6583435,PANEL_BORDER_WIDTH:2,BORDER_RADIUS:12,BUTTON_WIDTH:320,BUTTON_HEIGHT:60,BUTTON_COLOR:1976635,BUTTON_HOVER_COLOR:993823,BUTTON_SELECTED_COLOR:4906624,BUTTON_TEXT_COLOR:"#ffffff",BUTTON_SELECTED_TEXT_COLOR:"#4ade80",BUTTON_SPACING:25,FONT_FAMILY:"Quantico"};class Te{constructor(e,t){a(this,"scene");a(this,"container");a(this,"overlay");a(this,"isVisible",!1);a(this,"canPauseCallback",null);a(this,"buttons",[]);a(this,"selectedIndex",0);a(this,"escKey",null);a(this,"upKey",null);a(this,"downKey",null);a(this,"wKey",null);a(this,"sKey",null);a(this,"enterKey",null);a(this,"spaceKey",null);this.scene=e,this.canPauseCallback=t??null,this.overlay=e.add.rectangle(m/2,d/2,m,d,p.OVERLAY_COLOR,p.OVERLAY_ALPHA),this.overlay.setScrollFactor(0),this.overlay.setDepth(2e3),this.overlay.setVisible(!1),this.overlay.setInteractive(),this.container=e.add.container(m/2,d/2),this.container.setScrollFactor(0),this.container.setDepth(2001),this.container.setVisible(!1),this.createPanel(),this.createTitle(),this.createButtons(),this.setupInput()}createPanel(){const e=this.scene.add.graphics(),t=-420/2,s=-420/2,i=p.PANEL_WIDTH,n=p.PANEL_HEIGHT;e.fillStyle(0,.4),e.fillRoundedRect(t+6,s+6,i,n,p.BORDER_RADIUS),e.fillStyle(p.PANEL_COLOR,.92),e.fillRoundedRect(t,s,i,n,p.BORDER_RADIUS),e.lineStyle(p.PANEL_BORDER_WIDTH,p.PANEL_BORDER_COLOR,.6),e.strokeRoundedRect(t,s,i,n,p.BORDER_RADIUS);const o=20,r=6;e.lineStyle(2,p.BUTTON_SELECTED_COLOR,.7),e.beginPath(),e.moveTo(t-r,s+o),e.lineTo(t-r,s-r),e.lineTo(t+o,s-r),e.strokePath(),e.beginPath(),e.moveTo(t+i-o,s-r),e.lineTo(t+i+r,s-r),e.lineTo(t+i+r,s+o),e.strokePath(),e.beginPath(),e.moveTo(t-r,s+n-o),e.lineTo(t-r,s+n+r),e.lineTo(t+o,s+n+r),e.strokePath(),e.beginPath(),e.moveTo(t+i-o,s+n+r),e.lineTo(t+i+r,s+n+r),e.lineTo(t+i+r,s+n-o),e.strokePath(),e.lineStyle(1,9741240,.2),e.lineBetween(t+30,s+3,t+i-30,s+3),this.container.add(e)}createTitle(){const e=this.scene.add.text(0,-150,"Game is paused",{fontFamily:p.FONT_FAMILY,fontSize:"30px",color:"#94a3b8"});e.setOrigin(.5),this.container.add(e)}createButtons(){this.createButton(0,-50,"RESUME",()=>this.hide()),this.createButton(0,-50+p.BUTTON_HEIGHT+p.BUTTON_SPACING,"RESTART",()=>this.restart()),this.createButton(0,-50+(p.BUTTON_HEIGHT+p.BUTTON_SPACING)*2,"QUIT TO MENU",()=>this.quit());const t=this.scene.add.text(0,p.PANEL_HEIGHT/2-30,"â†‘â†“ Navigate  â€¢  ENTER Select  â€¢  ESC Resume",{fontFamily:p.FONT_FAMILY,fontSize:"12px",color:"#64748b"});t.setOrigin(.5),this.container.add(t)}createButton(e,t,s,i){const n=this.buttons.length,o=this.scene.add.graphics();this.drawButton(o,p.BUTTON_COLOR),o.setPosition(e,t),this.container.add(o);const r=this.scene.add.text(e,t,s,{fontFamily:p.FONT_FAMILY,fontSize:"24px",color:p.BUTTON_TEXT_COLOR,stroke:"#000000",strokeThickness:3});r.setOrigin(.5),this.container.add(r);const c=this.scene.add.rectangle(e,t,p.BUTTON_WIDTH,p.BUTTON_HEIGHT,16777215,0);c.setInteractive({useHandCursor:!0}),this.container.add(c);const u={bg:o,text:r,hitArea:c,callback:i};this.buttons.push(u),c.on("pointerover",()=>{this.selectButton(n)}),c.on("pointerdown",()=>{r.setScale(.95)}),c.on("pointerup",()=>{r.setScale(1.05),i()})}drawButton(e,t,s=!1){e.clear();const i=-320/2,n=-60/2,o=p.BUTTON_WIDTH,r=p.BUTTON_HEIGHT;if(s)for(let y=5;y>0;y--)e.lineStyle(y*2.5,p.BUTTON_SELECTED_COLOR,.08),e.strokeRoundedRect(i-y*2,n-y*2,o+y*4,r+y*4,8);e.fillStyle(t,.9),e.fillRoundedRect(i,n,o,r,8);const c=s?14742249:6583435;e.lineStyle(s?3:2,c,1),e.strokeRoundedRect(i,n,o,r,8);const u=12,l=4;e.lineStyle(2,c,s?1:.6),e.beginPath(),e.moveTo(i-l,n+u),e.lineTo(i-l,n-l),e.lineTo(i+u,n-l),e.strokePath(),e.beginPath(),e.moveTo(i+o-u,n-l),e.lineTo(i+o+l,n-l),e.lineTo(i+o+l,n+u),e.strokePath(),e.beginPath(),e.moveTo(i-l,n+r-u),e.lineTo(i-l,n+r+l),e.lineTo(i+u,n+r+l),e.strokePath(),e.beginPath(),e.moveTo(i+o-u,n+r+l),e.lineTo(i+o+l,n+r+l),e.lineTo(i+o+l,n+r-u),e.strokePath(),s&&(e.lineStyle(4,p.BUTTON_SELECTED_COLOR,.9),e.beginPath(),e.moveTo(i,n+12),e.lineTo(i,n+r-12),e.strokePath())}selectButton(e){e<0&&(e=this.buttons.length-1),e>=this.buttons.length&&(e=0);const t=this.selectedIndex;if(this.selectedIndex=e,t!==e&&this.buttons[t]){const i=this.buttons[t];this.drawButton(i.bg,p.BUTTON_COLOR,!1),i.text.setColor(p.BUTTON_TEXT_COLOR),i.text.setScale(1)}const s=this.buttons[e];this.drawButton(s.bg,p.BUTTON_HOVER_COLOR,!0),s.text.setColor(p.BUTTON_SELECTED_TEXT_COLOR),s.text.setScale(1.05),this.scene.sound.play("power-up-sfx",{volume:.2})}confirmSelection(){const e=this.buttons[this.selectedIndex];e&&(e.text.setScale(.95),this.scene.time.delayedCall(100,()=>{e.text.setScale(1.05),e.callback()}))}setupInput(){const e=this.scene.input.keyboard;e&&(this.escKey=e.addKey(h.Input.Keyboard.KeyCodes.ESC),this.escKey.on("down",()=>this.toggle()),this.upKey=e.addKey(h.Input.Keyboard.KeyCodes.UP),this.downKey=e.addKey(h.Input.Keyboard.KeyCodes.DOWN),this.wKey=e.addKey(h.Input.Keyboard.KeyCodes.W),this.sKey=e.addKey(h.Input.Keyboard.KeyCodes.S),this.enterKey=e.addKey(h.Input.Keyboard.KeyCodes.ENTER),this.spaceKey=e.addKey(h.Input.Keyboard.KeyCodes.SPACE),this.upKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex-1)}),this.wKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex-1)}),this.downKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex+1)}),this.sKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex+1)}),this.enterKey.on("down",()=>{this.isVisible&&this.confirmSelection()}),this.spaceKey.on("down",()=>{this.isVisible&&this.confirmSelection()}))}show(){this.isVisible||(this.isVisible=!0,this.scene.physics.pause(),this.selectedIndex=0,this.buttons.forEach((e,t)=>{const s=t===0;this.drawButton(e.bg,s?p.BUTTON_HOVER_COLOR:p.BUTTON_COLOR,s),e.text.setColor(s?p.BUTTON_SELECTED_TEXT_COLOR:p.BUTTON_TEXT_COLOR),e.text.setScale(s?1.05:1)}),this.overlay.setVisible(!0),this.container.setVisible(!0),this.overlay.setAlpha(0),this.container.setScale(.8),this.container.setAlpha(0),this.scene.tweens.add({targets:this.overlay,alpha:p.OVERLAY_ALPHA,duration:200,ease:"Power2"}),this.scene.tweens.add({targets:this.container,scale:1,alpha:1,duration:300,ease:"Back.easeOut"}))}hide(){this.isVisible&&(this.isVisible=!1,this.scene.tweens.add({targets:this.overlay,alpha:0,duration:200,ease:"Power2"}),this.scene.tweens.add({targets:this.container,scale:.8,alpha:0,duration:200,ease:"Power2",onComplete:()=>{this.overlay.setVisible(!1),this.container.setVisible(!1),this.scene.physics.resume()}}))}toggle(){if(this.isVisible)this.hide();else{if(this.canPauseCallback&&!this.canPauseCallback())return;this.show()}}restart(){this.isVisible=!1,this.scene.physics.resume(),this.scene.cameras.main.fadeOut(300,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.scene.restart()})}quit(){this.isVisible=!1,this.scene.physics.resume(),this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.scene.start("Versus")})}getIsVisible(){return this.isVisible}destroy(){var e,t,s,i,n,o,r;(e=this.escKey)==null||e.destroy(),(t=this.upKey)==null||t.destroy(),(s=this.downKey)==null||s.destroy(),(i=this.wKey)==null||i.destroy(),(n=this.sKey)==null||n.destroy(),(o=this.enterKey)==null||o.destroy(),(r=this.spaceKey)==null||r.destroy(),this.overlay.destroy(),this.container.destroy()}}const S={WIDTH:120,HEIGHT:16,PADDING_ABOVE_HEAD:20,BG_COLOR:1710638,FILL_COLOR:16729156,BORDER_COLOR:4868714,GLOW_COLOR:16729156,BORDER_RADIUS:8};class x{constructor(e,t,s,i,n=0){a(this,"scene");a(this,"container");a(this,"background");a(this,"fillBar");a(this,"border");a(this,"glowEffect");a(this,"label");a(this,"hpText");a(this,"targetSprite");a(this,"currentProgress",1);a(this,"targetProgress",1);a(this,"maxHealth");a(this,"currentHealth");a(this,"headOffset");this.scene=e,this.targetSprite=t,this.maxHealth=s,this.currentHealth=s,this.headOffset=n,this.container=e.add.container(0,0),this.container.setDepth(1e3),this.glowEffect=e.add.graphics(),this.container.add(this.glowEffect),this.background=e.add.graphics(),this.drawBackground(),this.container.add(this.background),this.fillBar=e.add.graphics(),this.container.add(this.fillBar),this.border=e.add.graphics(),this.drawBorder(),this.container.add(this.border),this.label=e.add.text(S.WIDTH/2,-20,i,{fontFamily:"monospace",fontSize:"12px",color:"#ffffff",fontStyle:"bold"}),this.label.setOrigin(.5,1),this.container.add(this.label),this.hpText=e.add.text(S.WIDTH/2,S.HEIGHT/2,"",{fontFamily:"monospace",fontSize:"10px",color:"#ffffff",fontStyle:"bold"}),this.hpText.setOrigin(.5,.5),this.container.add(this.hpText),this.updateHealth(s),e.events.on("update",this.update,this)}drawBackground(){this.background.clear(),this.background.fillStyle(S.BG_COLOR,.9),this.background.fillRoundedRect(0,0,S.WIDTH,S.HEIGHT,S.BORDER_RADIUS)}drawBorder(){this.border.clear(),this.border.lineStyle(2,S.BORDER_COLOR,1),this.border.strokeRoundedRect(0,0,S.WIDTH,S.HEIGHT,S.BORDER_RADIUS)}drawFill(e){if(this.fillBar.clear(),e<=0)return;const t=Math.max(0,(S.WIDTH-4)*e);this.fillBar.fillStyle(S.FILL_COLOR,1),this.fillBar.fillRoundedRect(2,2,t,S.HEIGHT-4,S.BORDER_RADIUS-2),this.fillBar.fillStyle(16777215,.3),this.fillBar.fillRoundedRect(2,2,t,(S.HEIGHT-4)/3,{tl:S.BORDER_RADIUS-2,tr:S.BORDER_RADIUS-2,bl:0,br:0})}drawGlow(e){if(this.glowEffect.clear(),e<=0)return;const t=(S.WIDTH-4)*e;this.glowEffect.fillStyle(S.GLOW_COLOR,.2),this.glowEffect.fillRoundedRect(-4,-4,t+8,S.HEIGHT+8,S.BORDER_RADIUS+2)}updateHealth(e){this.currentHealth=Math.max(0,Math.min(e,this.maxHealth)),this.targetProgress=this.currentHealth/this.maxHealth,this.hpText.setText(`${Math.ceil(this.currentHealth)} / ${this.maxHealth}`),this.targetProgress<=.3?(this.hpText.setColor("#ff4444"),this.label.setColor("#ff4444")):this.targetProgress<=.6?(this.hpText.setColor("#ffaa44"),this.label.setColor("#ffaa44")):(this.hpText.setColor("#ffffff"),this.label.setColor("#ffffff"))}update(e,t){const i=this.targetSprite.y-this.targetSprite.displayHeight+this.headOffset;this.container.setPosition(this.targetSprite.x-S.WIDTH/2,i-S.PADDING_ABOVE_HEAD),this.currentProgress+=(this.targetProgress-this.currentProgress)*.15,this.drawFill(this.currentProgress),this.drawGlow(this.currentProgress)}getCurrentHealth(){return this.currentHealth}getMaxHealth(){return this.maxHealth}destroy(){this.scene.events.off("update",this.update,this),this.container.destroy()}}const f={OVERLAY_COLOR:0,OVERLAY_ALPHA:.6,PANEL_WIDTH:480,PANEL_HEIGHT:350,PANEL_COLOR:1976635,PANEL_BORDER_COLOR:6583435,PANEL_BORDER_WIDTH:2,BORDER_RADIUS:12,BUTTON_WIDTH:320,BUTTON_HEIGHT:60,BUTTON_COLOR:1976635,BUTTON_HOVER_COLOR:993823,BUTTON_SELECTED_COLOR:4906624,BUTTON_TEXT_COLOR:"#ffffff",BUTTON_SELECTED_TEXT_COLOR:"#4ade80",BUTTON_SPACING:25,FONT_FAMILY:"Quantico"};class Se{constructor(e){a(this,"scene");a(this,"container");a(this,"overlay");a(this,"isVisible",!1);a(this,"titleText",null);a(this,"subtitleText",null);a(this,"buttons",[]);a(this,"selectedIndex",0);a(this,"upKey",null);a(this,"downKey",null);a(this,"wKey",null);a(this,"sKey",null);a(this,"enterKey",null);a(this,"spaceKey",null);this.scene=e,this.overlay=e.add.rectangle(m/2,d/2,m,d,f.OVERLAY_COLOR,f.OVERLAY_ALPHA),this.overlay.setScrollFactor(0),this.overlay.setDepth(2e3),this.overlay.setVisible(!1),this.overlay.setInteractive(),this.container=e.add.container(m/2,d/2),this.container.setScrollFactor(0),this.container.setDepth(2001),this.container.setVisible(!1),this.createPanel(),this.createButtons(),this.setupInput()}createPanel(){const e=this.scene.add.graphics(),t=-480/2,s=-350/2,i=f.PANEL_WIDTH,n=f.PANEL_HEIGHT;e.fillStyle(0,.4),e.fillRoundedRect(t+6,s+6,i,n,f.BORDER_RADIUS),e.fillStyle(f.PANEL_COLOR,.92),e.fillRoundedRect(t,s,i,n,f.BORDER_RADIUS),e.lineStyle(f.PANEL_BORDER_WIDTH,f.PANEL_BORDER_COLOR,.6),e.strokeRoundedRect(t,s,i,n,f.BORDER_RADIUS);const o=20,r=6;e.lineStyle(2,f.BUTTON_SELECTED_COLOR,.7),e.beginPath(),e.moveTo(t-r,s+o),e.lineTo(t-r,s-r),e.lineTo(t+o,s-r),e.strokePath(),e.beginPath(),e.moveTo(t+i-o,s-r),e.lineTo(t+i+r,s-r),e.lineTo(t+i+r,s+o),e.strokePath(),e.beginPath(),e.moveTo(t-r,s+n-o),e.lineTo(t-r,s+n+r),e.lineTo(t+o,s+n+r),e.strokePath(),e.beginPath(),e.moveTo(t+i-o,s+n+r),e.lineTo(t+i+r,s+n+r),e.lineTo(t+i+r,s+n-o),e.strokePath(),e.lineStyle(1,9741240,.2),e.lineBetween(t+30,s+3,t+i-30,s+3),this.container.add(e)}createButtons(){this.createButton(0,10,"RESTART",()=>this.restart()),this.createButton(0,10+f.BUTTON_HEIGHT+f.BUTTON_SPACING,"QUIT TO MENU",()=>this.quit());const t=this.scene.add.text(0,f.PANEL_HEIGHT/2-30,"â†‘â†“ Navigate  â€¢  ENTER Select",{fontFamily:f.FONT_FAMILY,fontSize:"12px",color:"#64748b"});t.setOrigin(.5),this.container.add(t)}createButton(e,t,s,i){const n=this.buttons.length,o=this.scene.add.graphics();this.drawButton(o,f.BUTTON_COLOR,!1),o.setPosition(e,t),this.container.add(o);const r=this.scene.add.text(e,t,s,{fontFamily:f.FONT_FAMILY,fontSize:"24px",color:f.BUTTON_TEXT_COLOR,stroke:"#000000",strokeThickness:3});r.setOrigin(.5),this.container.add(r);const c=this.scene.add.rectangle(e,t,f.BUTTON_WIDTH,f.BUTTON_HEIGHT,16777215,0);c.setInteractive({useHandCursor:!0}),this.container.add(c);const u={bg:o,text:r,hitArea:c,callback:i};this.buttons.push(u),c.on("pointerover",()=>{this.selectButton(n)}),c.on("pointerdown",()=>{r.setScale(.95)}),c.on("pointerup",()=>{r.setScale(1.05),i()})}drawButton(e,t,s=!1){e.clear();const i=-320/2,n=-60/2,o=f.BUTTON_WIDTH,r=f.BUTTON_HEIGHT;if(s)for(let y=5;y>0;y--)e.lineStyle(y*2.5,f.BUTTON_SELECTED_COLOR,.08),e.strokeRoundedRect(i-y*2,n-y*2,o+y*4,r+y*4,8);e.fillStyle(t,.9),e.fillRoundedRect(i,n,o,r,8);const c=s?14742249:6583435;e.lineStyle(s?3:2,c,1),e.strokeRoundedRect(i,n,o,r,8);const u=12,l=4;e.lineStyle(2,c,s?1:.6),e.beginPath(),e.moveTo(i-l,n+u),e.lineTo(i-l,n-l),e.lineTo(i+u,n-l),e.strokePath(),e.beginPath(),e.moveTo(i+o-u,n-l),e.lineTo(i+o+l,n-l),e.lineTo(i+o+l,n+u),e.strokePath(),e.beginPath(),e.moveTo(i-l,n+r-u),e.lineTo(i-l,n+r+l),e.lineTo(i+u,n+r+l),e.strokePath(),e.beginPath(),e.moveTo(i+o-u,n+r+l),e.lineTo(i+o+l,n+r+l),e.lineTo(i+o+l,n+r-u),e.strokePath(),s&&(e.lineStyle(4,f.BUTTON_SELECTED_COLOR,.9),e.beginPath(),e.moveTo(i,n+12),e.lineTo(i,n+r-12),e.strokePath())}selectButton(e){e<0&&(e=this.buttons.length-1),e>=this.buttons.length&&(e=0);const t=this.selectedIndex;if(this.selectedIndex=e,t!==e&&this.buttons[t]){const i=this.buttons[t];this.drawButton(i.bg,f.BUTTON_COLOR,!1),i.text.setColor(f.BUTTON_TEXT_COLOR),i.text.setScale(1)}const s=this.buttons[e];this.drawButton(s.bg,f.BUTTON_HOVER_COLOR,!0),s.text.setColor(f.BUTTON_SELECTED_TEXT_COLOR),s.text.setScale(1.05),this.scene.sound.play("power-up-sfx",{volume:.2})}confirmSelection(){const e=this.buttons[this.selectedIndex];e&&(e.text.setScale(.95),this.scene.time.delayedCall(100,()=>{e.text.setScale(1.05),e.callback()}))}setupInput(){const e=this.scene.input.keyboard;e&&(this.upKey=e.addKey(h.Input.Keyboard.KeyCodes.UP),this.downKey=e.addKey(h.Input.Keyboard.KeyCodes.DOWN),this.wKey=e.addKey(h.Input.Keyboard.KeyCodes.W),this.sKey=e.addKey(h.Input.Keyboard.KeyCodes.S),this.enterKey=e.addKey(h.Input.Keyboard.KeyCodes.ENTER),this.spaceKey=e.addKey(h.Input.Keyboard.KeyCodes.SPACE),this.upKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex-1)}),this.wKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex-1)}),this.downKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex+1)}),this.sKey.on("down",()=>{this.isVisible&&this.selectButton(this.selectedIndex+1)}),this.enterKey.on("down",()=>{this.isVisible&&this.confirmSelection()}),this.spaceKey.on("down",()=>{this.isVisible&&this.confirmSelection()}))}show(e){if(this.isVisible)return;this.isVisible=!0,this.scene.physics.pause(),this.selectedIndex=0,this.buttons.forEach((n,o)=>{const r=o===0;this.drawButton(n.bg,r?f.BUTTON_HOVER_COLOR:f.BUTTON_COLOR,r),n.text.setColor(r?f.BUTTON_SELECTED_TEXT_COLOR:f.BUTTON_TEXT_COLOR),n.text.setScale(r?1.05:1)}),this.titleText&&(this.container.remove(this.titleText),this.titleText.destroy(),this.titleText=null),this.subtitleText&&(this.container.remove(this.subtitleText),this.subtitleText.destroy(),this.subtitleText=null);const t=e==="player"?"VICTORY":"DEFEAT",s=e==="player"?"#4ade80":"#f87171";this.titleText=this.scene.add.text(0,-350/2+60,t,{fontFamily:f.FONT_FAMILY,fontSize:"48px",color:s,stroke:"#000000",strokeThickness:4}),this.titleText.setOrigin(.5),this.container.add(this.titleText);const i=e==="player"?"Enemy defeated!":"Better luck next time";this.subtitleText=this.scene.add.text(0,-350/2+110,i,{fontFamily:f.FONT_FAMILY,fontSize:"18px",color:"#94a3b8"}),this.subtitleText.setOrigin(.5),this.container.add(this.subtitleText),this.overlay.setVisible(!0),this.container.setVisible(!0),this.overlay.setAlpha(0),this.container.setScale(.8),this.container.setAlpha(0),this.scene.tweens.add({targets:this.overlay,alpha:f.OVERLAY_ALPHA,duration:200,ease:"Power2"}),this.scene.tweens.add({targets:this.container,scale:1,alpha:1,duration:300,ease:"Back.easeOut"})}hide(){this.isVisible&&(this.isVisible=!1,this.scene.tweens.add({targets:this.overlay,alpha:0,duration:200,ease:"Power2"}),this.scene.tweens.add({targets:this.container,scale:.8,alpha:0,duration:200,ease:"Power2",onComplete:()=>{this.overlay.setVisible(!1),this.container.setVisible(!1)}}))}restart(){this.isVisible=!1,this.scene.physics.resume(),this.scene.cameras.main.fadeOut(300,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.scene.start("Game")})}quit(){this.isVisible=!1,this.scene.physics.resume(),this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.scene.start("Versus")})}getIsVisible(){return this.isVisible}destroy(){var e,t,s,i,n,o;(e=this.upKey)==null||e.destroy(),(t=this.downKey)==null||t.destroy(),(s=this.wKey)==null||s.destroy(),(i=this.sKey)==null||i.destroy(),(n=this.enterKey)==null||n.destroy(),(o=this.spaceKey)==null||o.destroy(),this.overlay.destroy(),this.container.destroy()}}const k={IDLE_TO_CHASE_DISTANCE:2e3,CHASE_TO_IDLE_DISTANCE:600,ATTACK_DISTANCE:120,DISTANCE_VARIANCE:30,ATTACK_COOLDOWN:800,RETREAT_DURATION:500,ATTACK_PAUSE_CHANCE:.3,ATTACK_PAUSE_DURATION:200,RETREAT_CHANCE:.25,JUMP_WHILE_CHASING_CHANCE:.02,LOW_HEALTH_THRESHOLD:.3,LOW_HEALTH_RETREAT_CHANCE:.4};class Oe{constructor(e,t){a(this,"enemy");a(this,"player");a(this,"currentState",0);a(this,"stateTimer",0);a(this,"attackCooldown",k.ATTACK_COOLDOWN);a(this,"lastAttackTime",0);a(this,"attackPauseTimer",0);a(this,"isWaitingToAttack",!1);this.enemy=e,this.player=t}update(e){if(this.enemy.isDead()){this.enemy.stopMoving();return}if(this.player.isDead()){this.enemy.stopMoving(),this.currentState=0;return}this.stateTimer+=e,this.lastAttackTime+=e,this.attackPauseTimer>0&&(this.attackPauseTimer-=e);const t=this.player.getSprite().x,s=this.enemy.getX(),i=Math.abs(t-s);this.checkStateTransitions(i),this.executeStateBehavior(i,e)}checkStateTransitions(e){const t=(Math.random()-.5)*2*k.DISTANCE_VARIANCE;switch(this.currentState){case 0:e<k.IDLE_TO_CHASE_DISTANCE+t&&this.transitionTo(1);break;case 1:e<k.ATTACK_DISTANCE+t?this.transitionTo(2):e>k.CHASE_TO_IDLE_DISTANCE+t&&this.transitionTo(0);break;case 2:e>k.ATTACK_DISTANCE+20&&this.transitionTo(1);break;case 3:this.stateTimer>=k.RETREAT_DURATION&&this.transitionTo(1);break}}executeStateBehavior(e,t){switch(this.currentState){case 0:this.executeIdleBehavior();break;case 1:this.executeChaseBehavior(t);break;case 2:this.executeAttackBehavior();break;case 3:this.executeRetreatBehavior();break}}executeIdleBehavior(){this.enemy.stopMoving(),this.facePlayer()}executeChaseBehavior(e){const t=this.player.getSprite().x,s=this.enemy.getX();t<s?this.enemy.startMovingLeft():this.enemy.startMovingRight(),Math.random()<k.JUMP_WHILE_CHASING_CHANCE&&this.enemy.jump()}executeAttackBehavior(){if(this.facePlayer(),this.enemy.stopMoving(),this.isWaitingToAttack){this.attackPauseTimer<=0&&(this.isWaitingToAttack=!1,this.performAttack());return}if(this.lastAttackTime>=this.attackCooldown&&this.enemy.canAttack()){if(Math.random()<k.ATTACK_PAUSE_CHANCE){this.isWaitingToAttack=!0,this.attackPauseTimer=k.ATTACK_PAUSE_DURATION*(.5+Math.random());return}this.performAttack()}}performAttack(){if(Math.random()<.5?this.enemy.punch():this.enemy.sidekick()){this.lastAttackTime=0;const s=this.enemy.getCurrentHealth()/this.enemy.getMaxHealth()<k.LOW_HEALTH_THRESHOLD?k.LOW_HEALTH_RETREAT_CHANCE:k.RETREAT_CHANCE;Math.random()<s?setTimeout(()=>{this.currentState===2&&this.transitionTo(3)},200):setTimeout(()=>{this.currentState===2&&this.transitionTo(1)},100)}}executeRetreatBehavior(){const e=this.player.getSprite().x,t=this.enemy.getX();e<t?this.enemy.startMovingRight():this.enemy.startMovingLeft(),this.facePlayer()}transitionTo(e){this.enemy.stopMoving(),this.isWaitingToAttack=!1,this.currentState=e,this.stateTimer=0}facePlayer(){const e=this.player.getSprite().x,t=this.enemy.getX();this.enemy.setFacing(e>t)}getCurrentState(){return this.currentState}getStateName(){switch(this.currentState){case 0:return"IDLE";case 1:return"CHASE";case 2:return"ATTACK";case 3:return"RETREAT";default:return"UNKNOWN"}}forceState(e){this.transitionTo(e)}setAttackCooldown(e){this.attackCooldown=e}}const D=130;class be extends h.Scene{constructor(){super({key:"Game"});a(this,"player");a(this,"inputManager");a(this,"ground");a(this,"powerBoosters",[]);a(this,"enemies",[]);a(this,"boosterBar");a(this,"pauseMenu");a(this,"gameOverOverlay");a(this,"playerHealthBar");a(this,"enemyHealthBars",new Map);a(this,"gameEnded",!1);a(this,"debugUpdateHandler",null);a(this,"enemyAIControllers",[]);a(this,"updateCounter",0)}createBackground(){var i;const t=this.add.image(0,d/2,"bg-overgrown-city-sunset");t.setOrigin(0,.5);const s=d/t.height;t.setScale(s),t.setDepth(-100),(i=t.preFX)==null||i.addBlur(0,2,2,.3)}create(){console.log("[GameScene] Creating game world..."),this.gameEnded=!1,this.updateCounter=0,this.createBackground(),console.log("[GameScene] Background created"),this.inputManager=new ye(this),console.log("[GameScene] InputManager created"),this.createPlatforms(),console.log("[GameScene] Platforms created"),this.createFloorVisual(),console.log("[GameScene] Floor visual created"),this.createPlayer(),console.log("[GameScene] Player created"),this.createBoosterBar(),console.log("[GameScene] BoosterBar created"),this.createPowerBoosters(),console.log("[GameScene] PowerBoosters created"),this.createEnemies(),console.log("[GameScene] Enemies created"),this.player.setEnemyWarningChecker(()=>this.isAnyEnemyShowingWarning(),()=>this.getTimeUntilEnemyAttack()),console.log("[GameScene] Counter-dodge system linked"),this.setupCollisions(),console.log("[GameScene] Collisions set up"),this.setupCamera(),console.log("[GameScene] Camera set up"),this.createDebugInfo(),console.log("[GameScene] Debug info created"),this.createPauseMenu(),console.log("[GameScene] PauseMenu created"),this.createGameOverOverlay(),console.log("[GameScene] GameOverOverlay created"),this.createHealthBars(),console.log("[GameScene] HealthBars created"),this.registry.set("matchStarted",!1),this.createCountdown(),this.events.once("shutdown",this.shutdown,this)}createCountdown(){const s=this.add.text(m/2,140,"3",{fontFamily:"Quantico, Russo One, Arial",fontSize:"120px",fontStyle:"bold",color:"#ffffff",stroke:"#000000",strokeThickness:8});s.setOrigin(.5,.5),s.setDepth(500);const i=n=>{s.setText(String(n)),s.setScale(.5),this.tweens.add({targets:s,scale:1.2,duration:250,ease:"Back.easeOut",onComplete:()=>s.setScale(1)})};this.time.delayedCall(0,()=>i(3)),this.time.delayedCall(1e3,()=>i(2)),this.time.delayedCall(2e3,()=>i(1)),this.time.delayedCall(3e3,()=>{s.destroy(),this.registry.set("matchStarted",!0)})}createPauseMenu(){this.pauseMenu=new Te(this,()=>!this.gameEnded)}createGameOverOverlay(){this.gameOverOverlay=new Se(this)}createHealthBars(){this.playerHealthBar=new x(this,this.player.getSprite(),this.player.getMaxHealth(),"APE",117),this.player.setHealthBar(this.playerHealthBar),this.enemies.forEach(i=>{const n=new x(this,i.getSprite(),i.getMaxHealth(),"ENEMY",110);i.setHealthBar(n),this.enemyHealthBars.set(i,n)})}createBoosterBar(){this.boosterBar=new ge(this)}createPlatforms(){this.ground=this.physics.add.staticGroup();const t=this.add.graphics();t.fillStyle(4871528,1),t.fillRect(0,0,m,D),t.generateTexture("ground-texture",m,D),t.destroy();const s=260,i=this.add.graphics();i.fillStyle(7041664,1),i.fillRect(0,0,s,20),i.generateTexture("platform-texture",s,20),i.destroy(),this.ground.create(m/2,d-D/2+28,"ground-texture").refreshBody();const r=24;this.createPlatform(200,d-500+r),this.createPlatform(600,d-325+r),this.createPlatform(1100,d-450+r)}createPlatform(t,s){this.ground.create(t,s-20,"platform-texture").refreshBody();const r=this.add.image(t,s+26,"floating-platform"),u=350/r.width;r.setScale(u),r.setOrigin(.5,.95),r.setDepth(0)}createFloorVisual(){const t=this.add.image(0,d,"floor-overgrown-city");t.setOrigin(0,1);const s=m/t.width;t.setScale(s),t.setDepth(0)}createPowerBoosters(){this.powerBoosters.push(new w(this,400,d-D-50)),this.powerBoosters.push(new w(this,600,d-400)),this.powerBoosters.push(new w(this,1100,d-530))}createEnemies(){const t=new fe(this,m-100,d-D,this.inputManager);t.getSprite().setDepth(10),this.enemies.push(t);const s=new Oe(t,this.player);this.enemyAIControllers.push(s)}createPlayer(){const s=d-D;this.player=new pe(this,100,s,this.inputManager),this.player.getSprite().setDepth(10)}setupCollisions(){this.physics.add.collider(this.player.getSprite(),this.ground),this.enemies.forEach(t=>{this.physics.add.collider(t.getSprite(),this.ground)}),this.powerBoosters.forEach(t=>{this.physics.add.overlap(this.player.getSprite(),t.getSprite(),()=>{t.isAlreadyCollected()||t.collect(this.player.getSprite(),this.boosterBar)},void 0,this)})}setupCamera(){this.cameras.main.setBounds(0,0,m,d),this.cameras.main.startFollow(this.player.getSprite(),!0,.1,.1)}createDebugInfo(){console.log("[GameScene] Creating debug info");const t=this.add.text(10,10,"",{fontFamily:"monospace",fontSize:"14px",color:"#00ff00",backgroundColor:"#000000",padding:{x:5,y:5}});t.setScrollFactor(0),t.setDepth(1e3),this.debugUpdateHandler=()=>{const s=this.player.getSprite(),i=s.body;t.setText([`FPS: ${Math.round(this.game.loop.actualFps)}`,`Player: (${Math.round(s.x)}, ${Math.round(s.y)})`,`Velocity: (${Math.round((i==null?void 0:i.velocity.x)??0)}, ${Math.round((i==null?void 0:i.velocity.y)??0)})`,`On Ground: ${(i==null?void 0:i.blocked.down)??!1}`].join(`
`))},this.events.on("update",this.debugUpdateHandler)}update(){var s,i;try{if(this.updateCounter<3&&this.updateCounter++,this.gameEnded||(s=this.pauseMenu)!=null&&s.getIsVisible())return;(i=this.player)==null||i.update()}catch(n){throw n}this.enemies.forEach(n=>{n.update()});const t=this.game.loop.delta;this.enemyAIControllers.forEach((n,o)=>{this.enemies[o].isDead()||n.update(t)}),this.checkPlayerAttacks(),this.checkEnemyAttacks(),this.checkDeath()}checkPlayerAttacks(){const t=this.player.getAttackHitbox();t&&this.enemies.forEach(s=>{if(s.isDead()||s.getIsInvincible())return;const i=s.getSprite(),n=i.body,o=i.x-n.width/2,r=i.x+n.width/2,c=i.y-n.height/2,u=i.y+n.height/2,l=t.x+t.width,y=t.y+t.height;if(t.x<r&&l>o&&t.y<u&&y>c){const E=this.player.getAttackDamage(),C=this.player.getAttackType();s.takeDamage(E,this.player.getSprite().x,C??void 0)}})}checkEnemyAttacks(){this.player.isDead()||this.player.getIsInvincible()||this.enemies.forEach(t=>{if(t.isDead())return;const s=t.getAttackHitbox();if(!s)return;const i=this.player.getSprite(),n=i.body,o=i.x-n.width/2,r=i.x+n.width/2,c=i.y-n.height/2,u=i.y+n.height/2,l=s.x+s.width,y=s.y+s.height;if(s.x<r&&l>o&&s.y<u&&y>c){const E=t.getAttackDamage();this.player.takeDamage(E,t.getSprite().x)}})}checkDeath(){if(this.gameEnded)return;if(this.player.isDead()){this.gameEnded=!0,this.physics.pause(),this.gameOverOverlay.show("enemy");return}if(this.enemies.every(s=>s.isDead())&&this.enemies.length>0){this.gameEnded=!0,this.physics.pause(),this.gameOverOverlay.show("player");return}}isAnyEnemyShowingWarning(){return this.enemies.some(t=>!t.isDead()&&t.isShowingWarning())}getTimeUntilEnemyAttack(){let t=1/0;for(const s of this.enemies)if(!s.isDead()&&s.isShowingWarning()){const i=s.getTimeUntilAttack();i<t&&(t=i)}return t===1/0?0:t}shutdown(){var t,s,i;console.log("[GameScene] Shutting down..."),this.debugUpdateHandler&&(this.events.off("update",this.debugUpdateHandler),this.debugUpdateHandler=null),(t=this.pauseMenu)==null||t.destroy(),(s=this.gameOverOverlay)==null||s.destroy(),(i=this.playerHealthBar)==null||i.destroy(),this.enemyHealthBars.forEach(n=>n.destroy()),this.enemyHealthBars.clear(),this.powerBoosters=[],this.enemies=[],this.enemyAIControllers=[]}}const Ae=2500;class Ee extends h.Scene{constructor(){super({key:"Versus"})}create(){const e=this.add.image(m/2,d/2,"versus-bg");e.setDisplaySize(m,d),e.setDepth(0),this.cameras.main.fadeIn(300),this.time.delayedCall(Ae,()=>{this.cameras.main.fadeOut(400,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("Game")})})}}class _e extends h.Scene{constructor(){super({key:"Story"})}create(){var n;console.log("[StoryScene] Showing story placeholder"),this.createBackground();const e=this.sound.get("menu-music");e&&e.isPlaying,this.add.text(m/2,d/2-100,"Story",{fontFamily:"Russo One",fontSize:"72px",color:"#ffffff",stroke:"#000000",strokeThickness:8}).setOrigin(.5),this.add.text(m/2,d/2+50,"Coming Soon",{fontFamily:"Russo One",fontSize:"36px",color:"#cccccc",stroke:"#000000",strokeThickness:4}).setOrigin(.5),this.add.text(m/2,d-100,"Press ESC to return to menu",{fontFamily:"Arial",fontSize:"24px",color:"#888888"}).setOrigin(.5),(n=this.input.keyboard)==null||n.on("keydown-ESC",()=>{this.scene.start("Menu")})}createBackground(){const e=this.add.image(m/2,d/2,"bg-server-lab");e.setDisplaySize(m,d),e.setDepth(-100);const t=this.add.graphics();t.fillStyle(0,.5),t.fillRect(0,0,m,d),t.setDepth(-99)}}class ke extends h.Scene{constructor(){super({key:"Credits"})}create(){var n;console.log("[CreditsScene] Showing credits placeholder"),this.createBackground();const e=this.sound.get("menu-music");e&&e.isPlaying,this.add.text(m/2,d/2-100,"Credits",{fontFamily:"Russo One",fontSize:"72px",color:"#ffffff",stroke:"#000000",strokeThickness:8}).setOrigin(.5),this.add.text(m/2,d/2+50,"Coming Soon",{fontFamily:"Russo One",fontSize:"36px",color:"#cccccc",stroke:"#000000",strokeThickness:4}).setOrigin(.5),this.add.text(m/2,d-100,"Press ESC to return to menu",{fontFamily:"Arial",fontSize:"24px",color:"#888888"}).setOrigin(.5),(n=this.input.keyboard)==null||n.on("keydown-ESC",()=>{this.scene.start("Menu")})}createBackground(){const e=this.add.image(m/2,d/2,"bg-server-lab");e.setDisplaySize(m,d),e.setDepth(-100);const t=this.add.graphics();t.fillStyle(0,.5),t.fillRect(0,0,m,d),t.setDepth(-99)}}const m=1280,d=720,Ce={type:h.AUTO,parent:"game-container",width:m,height:d,backgroundColor:"#0d1117",scale:{mode:h.Scale.FIT,autoCenter:h.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{x:0,y:800},debug:!1,debugShowBody:!0,debugBodyColor:16711680}},scene:[N,de,me,Ee,be,_e,ke],render:{pixelArt:!1,antialias:!0,roundPixels:!1}};new h.Game(Ce);
//# sourceMappingURL=index-B9MaYYXO.js.map
